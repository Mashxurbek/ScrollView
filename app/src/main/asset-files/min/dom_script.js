Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var b=a.length;0<=--b&&a.item(b)!==this;);return-1<b});
var Dom={matches:function(a,b){return a&&b&&b.length?b.some(function(b){return a.matches(b)}):!1},next:function(a,b){return null==a?null:!b&&a.firstChild?a.firstChild:a.nextSibling?a.nextSibling:this.next(a.parentNode,!0)},previous:function(a){return null==a?null:a.previousSibling?a.previousSibling:a.parentNode?a.parentNode:null},isBefore:function(a,b,d){for(;null!=a;){if(a==b)return!0;if(a==d)break;a=this.next(a)}return!1},getOffsetToNode:function(a,b){1==arguments.length&&(b=a.parentElement);for(var d=
0,c=b.firstChild;null!=c;){if(c.nodeType==Node.TEXT_NODE){if(c==a||c.parentElement==a)break;d+=c.nodeValue.length}c=Dom.next(c)}return d},getElementOrAncestorBySelector:function(a,b){for(;null!=a&&a!=document.body;){if(a.nodeType==Node.ELEMENT_NODE&&Dom.matches(a,b))return a;a=a.parentElement}return null},getFirstAncestorOutsideOfProhibitedTree:function(a,b){var d=Dom.getElementOrAncestorBySelector(a,b);return null==d?a.nodeType==Node.ELEMENT_NODE?a:a.parentElement:Dom.getFirstAncestorOutsideOfProhibitedTree(d.parentElement,
b)},getNodeAndOffset:function(a,b){for(var d=0,c=a.firstChild;null!=c;){if(c.nodeType==Node.TEXT_NODE){var e=c.nodeValue.length,d=d+e;if(d>b)return{node:c,offset:e-(d-b)}}c=Dom.next(c)}return null},getTextNodesBetween:function(a,b){for(var d=[],c=a;null!=c;){c.nodeType==Node.TEXT_NODE&&0<c.nodeValue.length&&d.push(c);if(c==b)break;c=Dom.next(c)}return d}};